include ./../templates/ru-header.pug
include ./../templates/footer.pug
include ./../templates/textWithTags.pug

- var queryComplete = query ? query : ""

doctype html
html(lang='ru')
  head
    meta(charset="UTF-8")
    meta(http-equiv="X-UA-Compatible", content="IE=edge")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")

    meta(name="facebook-domain-verification" content="bd1qy6hoqnatx50dekig5hjn6q5j7v")

    title MetalCards - Твой дизайн
    
    link(rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png")
    link(rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png")
    link(rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png")
    link(rel="manifest" href="/site.webmanifest")
    meta(name="msapplication-TileColor" content="#da532c")
    meta(name="theme-color" content="#ffffff")
    
    link(rel="stylesheet", href="/design-promo/ru.css?ver=17")

    style
      | @font-face {
      |     font-family: "Gilroy";
      |     src: url('/fonts/gilroy-light.woff2') format('woff2'),
      |         url('/fonts/gilroy-light.woff') format('woff'),
      |         url('/fonts/gilroy-light.ttf') format('truetype');
      |     font-weight: 300;
      |     font-style: normal;
      | }

      | @font-face {
      |     font-family: "Beware";
      |     src: url('/fonts/beware-regular.woff2') format('woff2'),
      |         url('/fonts/beware-regular.woff') format('woff'),
      |         url('/fonts/beware-regular.ttf') format('truetype');
      |     font-weight: 400;
      |     font-style: normal;
      | }

      | @font-face {
      |   font-family: "Card";
      |   src: url('/fonts/card-regular.woff2') format('woff2'),
      |       url('/fonts/card-regular.woff') format('woff'),
      |       url('/fonts/card-regular.ttf') format('truetype');
      |   font-weight: 400;
      |   font-style: normal;
      | }

    style #{cardColorsCSS}
  
body
  h1.visually-hidden Страница, на которой вы можете создать свой дизайн карты

  +header("design", "твой дизайн", queryComplete)

  main
    h2.visually-hidden Конструктор

    -
      var fontsFamily = [
        "Gilroy",
        "Alex Brush", "Arabella", "Bodoni", "Card",
        "Candlescript", "Castileo", "Lombardia", "Monotype Corsiva",
        "Porcelain", "Postmaster", "Racing Catalogue", "Resphekt"
      ];

    each color in cardColors 
      input.visually-hidden(type="radio" id=color.name + "-card", value=color.name, name="card-color", checked="checked")

    section.configurator
      h3.visually-hidden Конфигуратор

      div.configurator__card-data#card-data-side-a
        div.configurator__card-data-radio-cont
          label(for="big-chip-input")
            input.visually-hidden#big-chip-input(type="radio", name="big-chip-input", value="true")
            span
            div 
              | Карта с 
              br
              | большим чипом
          label(for="small-chip-input")
            input.visually-hidden#small-chip-input(type="radio", name="big-chip-input", value="false", checked="checked")
            span
            div 
              | Карта с 
              br
              | маленьким чипом
        
        div.configurator__card-data-side-chooser
          button.configurator__card-data-side-chooser-btn.configurator__card-data-side-chooser-btn_active
            | Лицевая
            br
            | сторона
          button#card-data-a-to-card-data-b-btn.configurator__card-data-side-chooser-btn
            | Задняя
            br
            | сторона

        div.configurator__card-data-inscription#side-a-inscription
          div.configurator__card-data-inscription-desc
            label(for="side-a-inscription-text") надпись
            p 0/20
          input.configurator__card-data-inscription-text#side-a-inscription-text(type="text", name="side-a-inscription-text", placeholder="Надпись")

          div.configurator__card-data-inscription-cont.configurator__card-data-inscription-font-cont#side-a-inscription-font-cont
            button.configurator__card-data-inscription-cont-btn#side-a-inscription-font-cont-btn
              span(style="opacity: 0.5;") Шрифт
            div.configurator__card-data-inscription-cont-inner
              ul(class="configurator__card-data-inscription-cont-list")
                each font in fontsFamily
                  li.configurator__card-data-inscription-cont-list-item
                    label.configurator__card-data-inscription-cont-list-item-label
                      span #{font}
                      input.visually-hidden(type="radio", name="side-a-inscription-font", value=font)

          button.configurator__card-data-inscription-add-btn#side-a-inscription-add-btn Добавить еще одну надпись

      div.configurator__card-data#card-data-side-b

        div.configurator__card-data-owner-data
          div
            label(for="card-num-input") номер карты

          div
            label(for="card-time-input") срок действия

          input#card-num-input(type="text", pattern="[0-9]{4}\s[0-9]\s[0-9]\s[0-9]", placeholder="8600 1234 5678 9123", maxlength="19")
          
          div
            input#card-time-input(type="text", pattern="[0-9]{2}", placeholder="01", maxlength="2")
            span /
            input#card-time-2-input(type="text", pattern="[0-9]{2}", placeholder="01", maxlength="2")


        div.configurator__card-data-check-cont
          input.visually-hidden#remove-logo(type="checkbox", name="remove-logo")
          label(for="remove-logo")
            span
            div убрать логотип MetalCards (+50 000 сум)

        div.configurator__card-data-inscription#side-b-inscription
          div.configurator__card-data-inscription-desc
            label(for="side-b-inscription-text") надпись
            p 0/20
          input.configurator__card-data-inscription-text(type="text", name="side-b-inscription-text", id="side-b-inscription-text", placeholder="Надпись")

          div.configurator__card-data-inscription-cont.configurator__card-data-inscription-font-cont(id="side-b-inscription-font-cont")
            button.configurator__card-data-inscription-cont-btn(id="side-b-inscription-font-cont-btn") 
              span(style="opacity: 0.5;") Шрифт
            div.configurator__card-data-inscription-cont-inner
              ul(class="configurator__card-data-inscription-cont-list")
                each font in fontsFamily
                  li.configurator__card-data-inscription-cont-list-item
                    label.configurator__card-data-inscription-cont-list-item-label
                      span #{font}
                      input.visually-hidden(type="radio", name="side-b-inscription-font", value=font)

          button.configurator__card-data-inscription-add-btn#side-b-inscription-add-btn Добавить еще одну надпись

      
        div.configurator__card-data-side-chooser
          button#card-data-b-to-card-data-a-btn.configurator__card-data-side-chooser-btn
            | Лицевая
            br
            | сторона
          button.configurator__card-data-side-chooser-btn.configurator__card-data-side-chooser-btn_active
            | Задняя
            br
            | сторона
          

    section.visual
      h3.visually-hidden Визуализация карты

      input.visually-hidden#visualChoiceA(type="radio" value="A" name="visualChoice" checked="checked")
      input.visually-hidden#visualChoiceB(type="radio" value="B" name="visualChoice")

      div(class=`visual__card visual__card_${promo.color}`)
        div.visual__card-side-a
          div.visual__card-side-a-picture
            - var img = `/renders/${promo.folderName}/${cardColorsToRenderColors[promo.color]}/${promo.designID}`;
            picture
              source(srcset=`${img}.webp?ver=16` type="image/webp")
              img(src=`${img}.png?ver=16`)
          img.visual__card-side-a-chip.visual__card-side-a-chip_small(src="/images/chip-small.svg")


        div.visual__card-side-b
          div.visual__card-side-b-magnetic-stripe
          div.visual__card-side-b-signature-stripe
          div.visual__card-side-b-logo
          div.visual__card-side-b-card-num 8600 1234 5678 9123
          div.visual__card-side-b-card-time 01/25


      div.visual__bottom
        div
          h4.visual__bottom-header общая сумма
          p.visual__bottom-price 
            | #{Math.round(promo.promoPrice).toLocaleString("ru-RU")}
          span сум

        button.visual__bottom-btn
          span.visual__bottom-btn-inner
            span.visual__bottom-btn-inner_dark
              span Закажи
            span.visual__bottom-btn-inner_white
              span Закажи
  
    section.sub-designs

  +footer()

  section.buy-section
    div
      h4.buy-section-header общая сумма
      p.buy-section-price #{Math.round(promo.promoPrice).toLocaleString("ru-RU")}
      span сум

    button.buy-section-btn
      span.buy-section-btn__inner
        span.buy-section-btn__inner_dark
          span Закажи

        span.buy-section-btn__inner_white
          span Закажи

  div.buy-pop
    div.buy-pop__inner
      div.buy-pop__inner-header
        a.buy-pop__inner-header-logo(href="/ru/" + queryComplete)
          h2.visually-hidden Логотип компании и ссылка на главную страницу
          img(src="/images/logo-white.svg" alt="Логотип")

        button.buy-pop__inner-header-exit-btn

      div.preview.preview_hidden
        h3 Подтверди дизайн

        div.preview-card(id="preview-card-a")
          div.preview-card-img-cont
          img.preview-card-chip(src="/images/chip.svg")

        div.preview-card(id="preview-card-b")
          div.preview-card-img-cont
          div.preview-card-magnetic-stripe
          div.preview-card-signature-stripe
          div.preview-card-logo
        
        button.preview-confirm-btn подтвердить
        button.preview-return-btn вернуться к редактору
        
      div.confirm.confirm_hidden
        h2.confirm-header Подтверждение заказа

        label#confirm-name-label(for="confirm-name-input") Имя
        input#confirm-name-input(type="text", name="name", placeholder="Имя", maxlength="60")
        label#confirm-phone-label(for="confirm-phone-input") Номер телефона
        input#confirm-phone-input(type="text", name="phone", placeholder="(__) ___ __ __", maxlength="20")

        h3.confirm-heading Выберите способ получения

        div.confirm-check-cont
          input.visually-hidden#delivery-input(type="radio", name="way-to-get-input", value="delivery")
          label(for="delivery-input")
            span
            div 
              | Доставка по вилоятам Узбекистана +50&nbsp;000&nbsp;сум 
              br 
              | (с вами свяжется наш менеджер)

        div.confirm-check-cont
          input.visually-hidden#delivery-yandex-input(type="radio", name="way-to-get-input", value="delivery-yandex")
          label(for="delivery-yandex-input")
            span
            div 
              | Доставка Яндекс Такси 
              br
              | (оплата клиентом)

        div.confirm-check-cont
          input.visually-hidden#pickup-input(type="radio", name="way-to-get-input", value="pickup", checked)
          label(for="pickup-input")
            span
            div Самовывоз (Осие, 16)

        p.confirm-pre-price к оплате
        p.confirm-price #{Math.round(promo.promoPrice).toLocaleString("ru-RU")}

        button.confirm-pay-me-btn#payme-form-create-order
          span подтвердить заказ

      div.form-payme.form-payme__hidden
        h2.form-payme__header Оплата заказа

        button.form-payme__buy-btn#form-payme-link-click
          span оплатить через 
          img(src="/images/click.svg" alt="Click лого")

        button.form-payme__buy-btn#form-payme-link-payme
          span оплатить через 
          img(src="/images/payme.svg" alt="PayMe лого")

        button.form-payme__buy-btn#form-payme-link-cache
          span оплатить наличными
        
        button#form-payme-close-btn(type="button")
          span отменить заказ

        div.block-cache
          img(src="/images/block-cache-icon.svg", alt="")
          p 
            | Оплата наличными 
            br
            | только по Ташкенту
        

  <svg xmlns='http://www.w3.org/2000/svg' id="gold-gradient-svg" width='300%' height='300%'>
    <defs>
      <linearGradient id='gold-gradient' gradientUnits='userSpaceOnUse' x1='-10.36%' y1='25.06%' x2='110.36%' y2='74.94%'>
        <stop stop-color='#D5AC52'/>
        <stop offset='.963' stop-color='#EAD373'/>
      </linearGradient>
    </defs>
  </svg>

  div#promo-json #{JSON.stringify(promo)}

  div.visually-hidden#active-card-colors-names-json #{activeCardColorsNamesJSON}
  div.visually-hidden#card-colors-to-render-colors-json #{cardColorsToRenderColorsJSON}
  div.visually-hidden#default-color-name-json #{defaultColorNameJSON}


  <script src="/design-promo/ru.js?ver=17"></script>

  <!-- Meta Pixel Code -->
  script
    | !function(f,b,e,v,n,t,s)
    | {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    | n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    | if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    | n.queue=[];t=b.createElement(e);t.async=!0;
    | t.src=v;s=b.getElementsByTagName(e)[0];
    | s.parentNode.insertBefore(t,s)}(window, document,'script',
    | 'https://connect.facebook.net/en_US/fbevents.js');
    | fbq('init', '1176030859630983');
    | fbq('track', 'PageView');

  noscript
    img(height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1176030859630983&ev=PageView&noscript=1")
  <!-- End Meta Pixel Code -->

  <!-- Yandex.Metrika counter -->
  script
    | (function(m,e,t,r,i,k,a){m[i]=m[i] || function () {
    |   (m[i].a = m[i].a || []).push(arguments)
    | };
    |   m[i].l=1 * new Date();
    |   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
    |   k=e.createElement(t), a = e.getElementsByTagName(t)[0], k.async = 1, k.src = r, a.parentNode.insertBefore(k, a)})
    | (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    | ym(96006193, "init", {
    | clickmap:true,
    |   trackLinks:true,
    |   accurateTrackBounce:true,
    |   webvisor:true
    |   });
  noscript
    div
      img(src="https://mc.yandex.ru/watch/96006193" style="position:absolute; left:-9999px;" alt="")
  <!-- /Yandex.Metrika counter -->